<template name="cartPage">
	<center><h1 class="page-title">{{_ "cart"}}</h1></center>
	{{#unless empty}}
		<div class="cart-items-list">
		{{#each purchases}}
			{{> cartItem }}
		{{/each}}
		</div>
		{{#if showDeliveryForm}}
			{{> deliveryInformationForm }}
		{{else}}
		<center><button class="btn btn-warning btn-lg btn-block btn-raised submit-cart-btn">
			{{_ "submitCart"}}</button></center>
		{{/if}}
		<div style="margin-top:20px;" ></div>		
	{{else}}
		<p class="no-cart-items-message">{{_ "noItemsMessage"}}</p>
	{{/unless}}
</template>

<template name="cartItem">
	<div class="row cart-item">		
		{{> cartItemForm this}}
		{{> itemThumbnail item}}			
		<hr class="col-xs-12" style="margin-top:0px;"/>
	</div>
</template>

<template name="cartItemForm">
	<div class="col-xs-6">
	{{#autoForm 
		collection=formCollection 
		id=cartItemFormId
		type="method-update"
		doc=this
		autosaveOnKeyup=true
		resetOnSuccess=false
		trimStrings=false
		meteormethod="cart.updatePurchase"}}
		{{> afQuickField name='notes' label=false rows=5 placeholder=notesPlaceholder}}
		<button 
			class="btn btn-danger btn-fab btn-fab-mini remove-cart-item-btn" 
			style="float:left; top:25px;">
			<i class="material-icons">clear</i></button>		
		{{> afQuickField name='quantity' style="width:50%; display:inline-block;" type="number"}}
	{{/autoForm}}
	</div>
</template>

<template name="deliveryInformationForm">

	<p>{{_ "insertDeliveryInfoPlease"}}:</p>
	{{#autoForm 
		schema=formCollection 
		id="deliveryInformationForm" 
		type="method"
		doc=defaultValues
		meteormethod="cart.submit"}}

		{{> afQuickField name='email'}}
		{{> afQuickField name='phone'}}
		{{> afQuickField name='deliveryAddress'}}
		{{> afQuickField name='deliveryDate'}}

		<center><button class="btn btn-warning btn-block btn-raised submit-cart-final-btn">
			{{_ "submitCart"}}</button></center>

	{{/autoForm}}


</template>



