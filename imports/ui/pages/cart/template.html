<template name="cartPage">
	<h1 class="page-title">Your Cart</h1>
	{{#unless empty}}
		<div class="cart-items-list">
		{{#each purchases}}
			{{> cartItem }}
		{{/each}}
		</div>
		{{#if showDeliveryForm}}
			{{> deliveryInformationForm }}
		{{else}}
		<button class="btn btn-primary submit-cart-btn">Submit cart</button>
		{{/if}}
	{{else}}
		<p class="no-cart-items-message">There are no items in your cart</p>
	{{/unless}}
</template>

<template name="cartItem">
	<div class="row cart-item">		
		{{> itemThumbnail item}}
		{{> cartItemForm this}}
	</div>
</template>

<template name="cartItemForm">
	<div class="item-thumbnail col-sm-6 col-md-4">
	{{#autoForm 
		collection=formCollection 
		id=cartItemFormId
		type="method-update"
		doc=this
		autosaveOnKeyup=true
		resetOnSuccess=false
		trimStrings=false
		meteormethod="cart.updatePurchase"}}
		{{> afQuickField name='notes'}}
		{{> afQuickField name='quantity'}}
	{{/autoForm}}
	<button class="btn btn-danger remove-cart-item-btn">Remove cart item</button>	
	</div>
</template>

<template name="deliveryInformationForm">

	{{#autoForm 
		schema=formCollection 
		id="deliveryInformationForm" 
		type="method"
		doc=defaultValues
		meteormethod="cart.submit"}}

		{{> afQuickField name='email'}}
		{{> afQuickField name='phone'}}
		{{> afQuickField name='deliveryAddress'}}
		{{> afQuickField name='deliveryDate'}}

		<button class="btn btn-primary submit-cart-final-btn">Confirm Submit cart</button>

	{{/autoForm}}


</template>



